<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Transaction History - Oakline Bank</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet" />
  <style>
    body { background-color: #f8f9fa; }
    table th, table td { vertical-align: middle; }
  </style>
</head>
<body>
  <nav class="navbar navbar-light bg-light px-3">
    <a href="index.html" class="navbar-brand">Oakline Bank</a>
    <div class="dropdown">
      <button class="btn btn-sm btn-light dropdown-toggle" data-bs-toggle="dropdown">
        <i class="fas fa-bars me-1"></i> Menu
      </button>
      <ul class="dropdown-menu dropdown-menu-end">
        <li><a class="dropdown-item" href="dashboard.html">Dashboard</a></li>
        <li><a class="dropdown-item" href="deposit.html">Deposit Funds</a></li>
        <li><a class="dropdown-item" href="withdrawal.html">Withdraw Funds</a></li>
        <li><a class="dropdown-item" href="index.html">Logout</a></li>
      </ul>
    </div>
  </nav>

  <div class="container mt-5">
    <h4 class="mb-4">All Transactions</h4>
    <div class="table-responsive">
      <table class="table table-bordered table-hover text-center align-middle">
<thead class="table-light">
  <tr>
    <th>Date</th>
    <th>Type</th>
    <th>Description</th>
    <th>Amount ($)</th>
    <th>Balance After</th>
    <th>Receipt</th> <!-- âœ… New column -->
  </tr>
</thead>
        <tbody id="transactionTableBody"></tbody>
      </table>
    </div>
    <div id="noTransactions" class="text-muted text-center mt-4 d-none">
      No transactions yet.
    </div>
  </div>

<script>
  const transactions = JSON.parse(localStorage.getItem('transactions')) || [];
  const tbody = document.getElementById('transactionTableBody');
  const empty = document.getElementById('noTransactions');
  let runningBalance = 0;

  if (transactions.length === 0) {
    empty.classList.remove('d-none');
  } else {
    transactions.forEach((tx, index) => {
      if (tx.type === "Deposit") {
        runningBalance += parseFloat(tx.amount);
      } else if (tx.type === "Withdrawal" || tx.type === "Transfer") {
        runningBalance -= parseFloat(tx.amount);
      }

      const row = document.createElement('tr');

      const receiptBtn = tx.type === "Transfer"
        ? `<button class="btn btn-sm btn-outline-secondary" onclick="viewReceipt(${index})" title="View Receipt">
             <i class="fas fa-receipt"></i>
           </button>`
        : "";

      row.innerHTML = `
        <td>${tx.date}</td>
        <td>${tx.type}</td>
        <td>${tx.description || '-'}</td>
        <td class="${tx.type === 'Deposit' ? 'text-success' : 'text-danger'}">
          ${tx.type === 'Deposit' ? '+' : '-'}$${parseFloat(tx.amount).toFixed(2)}
        </td>
        <td>$${runningBalance.toFixed(2)}</td>
        <td>${receiptBtn}</td>
      `;
      tbody.appendChild(row);
    });
  }

  function viewReceipt(index) {
    const tx = transactions[index];
    localStorage.setItem('latestTransaction', JSON.stringify(tx));
    window.location.href = "receipt.html";
  }
</script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
