<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Supabase Test Insert</title>
</head>
<body>
<h1>Supabase Test Insert</h1>
<pre id="output"></pre>

<script type="module">
import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

const supabaseUrl = 'https://ockhxxigrqmbuotkupfl.supabase.co';
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9ja2h4eGlncnFtYnVvdGt1cGZsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU1MTEzNzYsImV4cCI6MjA3MTA4NzM3Nn0.ZQaEXgJ2jLFFErI3eTY53cMaQrf1w19GhuGyN31WAOw';
const supabase = createClient(supabaseUrl, supabaseKey);

const output = document.getElementById("output");

async function testInsert() {
  output.textContent = "Running test...\n";

  try {
    // Insert into profiles
    const { data: profileData, error: profileError } = await supabase
      .from('profiles')
      .insert([{
        email: 'chite7074@gmail.com',
        username: 'chite7074',
        first_name: 'Chite',
        middle_name: '',
        last_name: 'Test',
        password_hash: 'Churchman23$',  // For testing only; normally hash password
        ssn: '123-45-6789',
        phone: '555-1234',
        address: '123 Main St',
        city: 'City',
        state: 'State',
        country: 'Country'
      }]);
    if (profileError) throw profileError;
    output.textContent += "Profile inserted: " + JSON.stringify(profileData) + "\n";

    // Insert into accounts
    const { data: accountData, error: accountError } = await supabase
      .from('accounts')
      .insert([{
        user_id: profileData[0].id, // use the UUID generated automatically
        type: 'checking',
        balance: 0,
        account_number: '6973833794',
        routing_number: '075915826'
      }]);
    if (accountError) throw accountError;
    output.textContent += "Account inserted: " + JSON.stringify(accountData) + "\n";

    output.textContent += "✅ Test insert completed successfully!";
  } catch (err) {
    output.textContent += "❌ Test insert failed: " + err.message;
    console.error(err);
  }
}

testInsert();
</script>
</body>
</html>
